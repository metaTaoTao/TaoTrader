{
  "nodes": [
    {
      "id": "Telegram Trigger",
      "parameters": {
        "updates": ["message"],
        "credentials": {
          "telegramApi": {
            "id": "YOUR_TELEGRAM_CREDENTIAL_ID"
          }
        }
      },
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1,
      "position": [200, 300]
    },
    {
      "id": "Extract Ticker",
      "parameters": {
        "functionCode": "const text = $json[\"message\"][\"text\"] || \"\";\nconst ticker = text.split(\" \")[1] || \"BTCUSDT\";\nreturn [{ ticker: ticker.toUpperCase() }];"
      },
      "name": "Extract Ticker",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [400, 300]
    },
    {
      "id": "Get Chart",
      "parameters": {
        "authentication": "headerAuth",
        "requestMethod": "POST",
        "url": "https://api.chart-img.com/v1/chart",
        "jsonParameters": true,
        "options": {},
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer YOUR_CHART_IMG_API_KEY"
        },
        "bodyContent": {
          "symbol": "={{$json[\"ticker\"]}}",
          "interval": "1h",
          "theme": "dark",
          "studies": ["ema", "volume"]
        }
      },
      "name": "Get Chart",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [600, 300]
    },
    {
      "id": "GPT-4-Vision",
      "parameters": {
        "model": "gpt-4-vision-preview",
        "messages": [
          {
            "role": "user",
            "content": [
              {
                "type": "text",
                "text": "你是一位专业的加密货币技术分析师，请根据这张图表判断当前趋势结构、量能情况、支撑阻力位，并用简洁的中文写出操作建议（如买入/观望/卖出）。"
              },
              {
                "type": "image_url",
                "image_url": {
                  "url": "={{$node[\"Get Chart\"].json[\"body\"][\"url\"]}}"
                }
              }
            ]
          }
        ],
        "temperature": 0.7
      },
      "name": "GPT-4-Vision",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 2,
      "position": [800, 300],
      "credentials": {
        "openAiApi": {
          "id": "YOUR_OPENAI_API_CREDENTIAL_ID"
        }
      }
    },
    {
      "id": "Send to Telegram",
      "parameters": {
        "chatId": "={{$json[\"message\"][\"chat\"][\"id\"]}}",
        "text": "={{$node[\"GPT-4-Vision\"].json[\"data\"][\"choices\"][0][\"message\"][\"content\"]}}"
      },
      "name": "Send to Telegram",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1000, 300],
      "credentials": {
        "telegramApi": {
          "id": "YOUR_TELEGRAM_CREDENTIAL_ID"
        }
      }
    }
  ],
  "connections": {
    "Telegram Trigger": {
      "main": [["Extract Ticker"]]
    },
    "Extract Ticker": {
      "main": [["Get Chart"]]
    },
    "Get Chart": {
      "main": [["GPT-4-Vision"]]
    },
    "GPT-4-Vision": {
      "main": [["Send to Telegram"]]
    }
  }
}
