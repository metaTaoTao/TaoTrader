# æœåŠ¡å™¨å®šæ—¶æ‹‰å–æŒ‡å—

## ðŸŽ¯ æ¦‚è¿°

`run/pull_coin_info.py` æ˜¯ä¸“ä¸ºæœåŠ¡å™¨å®šæ—¶ä»»åŠ¡è®¾è®¡çš„å¸ç§ä¿¡æ¯æ‹‰å–å·¥å…·ï¼Œé‡‡ç”¨**å®Œå…¨é‡å»ºæ¨¡å¼**ï¼Œæ¯æ¬¡è¿è¡Œéƒ½é‡æ–°æ‹‰å–æ‰€æœ‰å¸ç§ä¿¡æ¯ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚

## ðŸ“ ç›¸å…³æ–‡ä»¶

```
TaoTrader/
â”œâ”€â”€ run/
â”‚   â”œâ”€â”€ pull_coin_info.py           # ðŸŽ¯ ä¸»æ‹‰å–è„šæœ¬
â”‚   â”œâ”€â”€ daily_pull.sh               # ðŸ§ Linuxå®šæ—¶ä»»åŠ¡è„šæœ¬
â”‚   â””â”€â”€ logs/                       # ðŸ“ æ—¥å¿—ç›®å½•
â”œâ”€â”€ update_mapping_table.py         # ðŸ”§ æ˜ å°„è¡¨æ›´æ–°å·¥å…·
â”œâ”€â”€ tickers.json                    # ðŸ“„ å¸ç§åˆ—è¡¨
â”œâ”€â”€ coin_mapping_table.csv          # ðŸ“Š ç”Ÿæˆçš„æ˜ å°„è¡¨
â””â”€â”€ backups/                        # ðŸ’¾ å¤‡ä»½ç›®å½•
```

## ðŸš€ éƒ¨ç½²æ­¥éª¤

### 1. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
```bash
# æ ¸å¿ƒæ–‡ä»¶
scp data/sector_data.py user@server:/path/to/TaoTrader/data/
scp utils/coingecko_helper.py user@server:/path/to/TaoTrader/utils/
scp update_mapping_table.py user@server:/path/to/TaoTrader/
scp run/pull_coin_info.py user@server:/path/to/TaoTrader/run/
scp run/daily_pull.sh user@server:/path/to/TaoTrader/run/
scp tickers.json user@server:/path/to/TaoTrader/
scp requirements.txt user@server:/path/to/TaoTrader/
```

### 2. æœåŠ¡å™¨çŽ¯å¢ƒå‡†å¤‡
```bash
cd /path/to/TaoTrader

# å®‰è£…ä¾èµ–
pip3 install requests pandas

# è®¾ç½®æ‰§è¡Œæƒé™
chmod +x run/daily_pull.sh
chmod +x run/pull_coin_info.py

# åˆ›å»ºå¿…è¦ç›®å½•
mkdir -p run/logs
mkdir -p backups
```

### 3. é¦–æ¬¡æ‰‹åŠ¨æ‰§è¡Œæµ‹è¯•
```bash
# æµ‹è¯•æ‹‰å–è„šæœ¬
python3 run/pull_coin_info.py

# æˆ–ä½¿ç”¨shellè„šæœ¬
./run/daily_pull.sh
```

### 4. è®¾ç½®å®šæ—¶ä»»åŠ¡
```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ æ¯æ—¥å‡Œæ™¨2ç‚¹æ‰§è¡Œ
0 2 * * * /path/to/TaoTrader/run/daily_pull.sh

# æˆ–è€…æ¯12å°æ—¶æ‰§è¡Œä¸€æ¬¡
0 */12 * * * /path/to/TaoTrader/run/daily_pull.sh
```

## âš™ï¸ è¶…ä¿å®ˆAPIç­–ç•¥

### 1. æ—¶é—´é—´éš”è®¾ç½®
```
åŸºç¡€ç­‰å¾…: 20ç§’
APIè°ƒç”¨é—´éš”: 5ç§’
æ‰¹æ¬¡é—´éš”: 60ç§’
é‡è¯•é—´éš”: 20s â†’ 40s â†’ 80s â†’ 160s â†’ 320s
```

### 2. åˆ†æ‰¹å¤„ç†
- **æ‰¹æ¬¡å¤§å°**: 5ä¸ªå¸ç§/æ‰¹
- **æ‰¹æ¬¡é—´éš”**: 60ç§’
- **å¤±è´¥é‡è¯•**: æœ€å¤š5æ¬¡

### 3. ç¼“å­˜ç­–ç•¥
- **ç¼“å­˜æ–‡ä»¶**: `coingecko_cache_server.pkl`
- **æœ‰æ•ˆæœŸ**: 24å°æ—¶
- **ç«‹å³ä¿å­˜**: æ¯æ¬¡æˆåŠŸèŽ·å–æ•°æ®åŽç«‹å³ä¿å­˜

## ðŸ“Š æ‰§è¡Œæµç¨‹

### 1. åˆå§‹åŒ–é˜¶æ®µ
```
ðŸš€ å¯åŠ¨æ‹‰å–æœåŠ¡
ðŸ“„ åŠ è½½tickeråˆ—è¡¨ (tickers.json)
ðŸ”§ åˆå§‹åŒ–SectorFetcher
ðŸ’¾ åŠ è½½çŽ°æœ‰ç¼“å­˜
```

### 2. å®Œå…¨é‡å»ºé˜¶æ®µ
```
ðŸ—‘ï¸ æ¸…ç©ºçŽ°æœ‰æ˜ å°„è¡¨
ðŸ“¦ åˆ†æ‰¹å¤„ç† (æ¯æ‰¹3ä¸ªå¸ç§)
â³ å¸ç§é—´ç­‰å¾…10ç§’ï¼Œæ‰¹æ¬¡é—´ç­‰å¾…90ç§’
ðŸ” æ™ºèƒ½åŒ¹é… (é€‰æ‹©å¸‚å€¼æœ€å¤§çš„)
ðŸ’¾ æ‰¹é‡ä¿å­˜æ‰€æœ‰æˆåŠŸæ•°æ®
ðŸ“ è¯¦ç»†æ—¥å¿—è®°å½•
```

### 3. å®Œæˆé˜¶æ®µ
```
ðŸ“Š ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š
ðŸ’¾ åˆ›å»ºæ•°æ®å¤‡ä»½
ðŸ§¹ æ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶
ðŸ“‹ è¾“å‡ºæ‰§è¡Œæ‘˜è¦
```

## ðŸ“‹ ç”Ÿæˆçš„æ–‡ä»¶

### 1. æ˜ å°„è¡¨æ–‡ä»¶
```csv
ticker,base_symbol,name,coingecko_id,market_cap_rank,market_cap,fdv,volume_24h,price_change_24h,categories,last_updated
BTCUSDT,btc,Bitcoin,bitcoin,1,1000000000000,1000000000000,50000000000,2.5,Store of Value;Digital Gold,2025-01-21 02:30:00
ANIMEUSDT,anime,Animecoin,anime,592,87600000,158170000,13110000,-0.88,NFT;Meme;Arbitrum Ecosystem,2025-01-21 02:31:00
```

### 2. æ—¥å¿—æ–‡ä»¶
```
run/logs/pull_coin_info_20250121.log
```

### 3. å¤‡ä»½æ–‡ä»¶
```
backups/coin_mapping_20250121_0230.csv
```

## ðŸ”§ ç›‘æŽ§å’Œç»´æŠ¤

### 1. æ£€æŸ¥æ‰§è¡ŒçŠ¶æ€
```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f run/logs/pull_coin_info_$(date +%Y%m%d).log

# æ£€æŸ¥cronæ‰§è¡Œ
tail -f /var/log/cron

# æŸ¥çœ‹æ˜ å°„è¡¨ç»Ÿè®¡
python3 update_mapping_table.py --stats
```

### 2. æ‰‹åŠ¨é‡æ–°æ‹‰å–
```bash
# å¼ºåˆ¶æ›´æ–°æ‰€æœ‰æ•°æ®
python3 run/pull_coin_info.py

# æˆ–è€…æ›´æ–°ç‰¹å®šå¸ç§
python3 update_mapping_table.py BTCUSDT ETHUSDT --force
```

### 3. æ•…éšœæŽ’é™¤
```bash
# æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
curl -I "https://api.coingecko.com/api/v3/ping"

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥PythonçŽ¯å¢ƒ
python3 -c "import requests, pandas; print('âœ… ä¾èµ–æ­£å¸¸')"
```

## ðŸŽ¯ TG Boté›†æˆ

### 1. ç¡®ä¿æ˜ å°„è¡¨å­˜åœ¨
```bash
ls -la coin_mapping_table.csv
```

### 2. å¯åŠ¨TG Bot
```bash
python3 run/run_tg_bot.py
```

### 3. æµ‹è¯•tickeræŸ¥è¯¢
```
/ticker ANIMEUSDT    # åº”è¯¥çž¬é—´è¿”å›žç»“æžœ
/ticker BTCUSDT      # ä»Žæœ¬åœ°æ˜ å°„è¡¨è¯»å–
```

## ðŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### é¢„æœŸæ‰§è¡Œæ—¶é—´ï¼ˆ100ä¸ªå¸ç§ï¼‰
- **åˆå§‹åŒ–**: 2-5åˆ†é’Ÿ
- **å®Œå…¨é‡å»º**: 60-120åˆ†é’Ÿï¼ˆæ¯æ‰¹3ä¸ªå¸ç§ï¼Œé—´éš”90ç§’ï¼‰
- **æ€»è€—æ—¶**: 65-125åˆ†é’Ÿ

### æ—¶é—´è®¡ç®—å…¬å¼
```
æ€»æ—¶é—´ â‰ˆ åˆå§‹åŒ–æ—¶é—´ + (å¸ç§æ•°é‡ Ã· 3) Ã— 90ç§’ + APIè°ƒç”¨æ—¶é—´
ä¾‹å¦‚100ä¸ªå¸ç§ â‰ˆ 5åˆ†é’Ÿ + 34æ‰¹ Ã— 90ç§’ + 30åˆ†é’Ÿ â‰ˆ 86åˆ†é’Ÿ
```

### æˆåŠŸçŽ‡ç›®æ ‡
- **ç›®æ ‡æˆåŠŸçŽ‡**: >95%
- **å¯æŽ¥å—æˆåŠŸçŽ‡**: >90%
- **å‘Šè­¦é˜ˆå€¼**: <80%

## âš¡ å…³é”®ä¼˜åŠ¿

### 1. ç¨³å®šæ€§
- âœ… è¶…ä¿å®ˆçš„APIè°ƒç”¨ç­–ç•¥
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- âœ… åˆ†æ‰¹å¤„ç†é¿å…é•¿æ—¶é—´é˜»å¡ž

### 2. å¯é æ€§
- âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
- âœ… è‡ªåŠ¨å¤‡ä»½æœºåˆ¶
- âœ… ç¼“å­˜æœºåˆ¶å‡å°‘å¤±è´¥å½±å“

### 3. å¯ç»´æŠ¤æ€§
- âœ… æ¸…æ™°çš„æ‰§è¡Œæµç¨‹
- âœ… å®Œå–„çš„ç›‘æŽ§å·¥å…·
- âœ… çµæ´»çš„é…ç½®é€‰é¡¹

çŽ°åœ¨ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šå®‰å¿ƒåœ°è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œæ¯å¤©è‡ªåŠ¨æ‹‰å–æœ€æ–°çš„å¸ç§ä¿¡æ¯ï¼ŒTG Botç”¨æˆ·å°†äº«å—æžå¿«çš„æŸ¥è¯¢å“åº”ï¼ðŸŽ‰
